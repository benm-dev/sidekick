var S={authDomains:["login.microsoftonline.com","login.live.com","account.live.com","signup.live.com","login.microsoft.com","teams.microsoft.com","fpt.live.com"],hasFocusMode:!0,hasNotificationSound:!0,id:"msteams",name:"Microsoft Teams",onboardingGrade:-1,startURL:"https://teams.live.com"};window.sidekick(t=>{let c=t.assert,n={activityLink:"#app-bar-14d6962d-6eeb-4f48-8890-de55454bb136",chatsLink:"#app-bar-86fcd49b-61a2-4701-b771-54728cd291fb",clearStatusNeverItem:".ts-dropdown-select-options-wrapper li:nth-child(1)",customStatusInput:"#settingsSetNote-statusInputBox",expandClearStatusButton:'[ng-click="setNoteController.keyboardToggleExpiry($event)"] span',linkBadge:".activity-badge",setCustomStatusButton:'[data-tid="setStatusNoteButton"]',submitStatusButton:'[ng-click="setNoteController.setStatus()"]',userButton:'[data-tid="personDropdown"]'},m=e=>`No element for selector ${e}`,d=45e3,w="msal.idtoken",p=async()=>{if(!t.isLocalStorageItemExist(w))return;let e=await t.waitUntilElementExist(document,n.activityLink,d);c(!!e,m("activityLink"),{extra:{url:document.URL,windowWidth:window.innerWidth}});let a=await t.waitUntilElementExist(document,n.chatsLink,d);c(!!a,m("chatsLink"),{extra:{url:document.URL,windowWidth:window.innerWidth}});let r=e.querySelector(n.linkBadge),l=a.querySelector(n.linkBadge),o=0,u=0;r&&(o=Number.parseInt(r.innerText,10)||0),l&&(u=Number.parseInt(l.innerText,10)||0);let i=o+u;t.setBadge(i)},s=null,b=async({text:e,requestedAt:a,force:r=!1,dontClearStatus:l=!1})=>{if(!r&&window.localStorage.getItem("sidekick.last_status_text")===e)return!1;let o=await t.waitUntilElementExist(document,n.userButton);if(s!==a)return!1;o.click();let u=await t.waitUntilElementExist(document,n.setCustomStatusButton);if(s!==a)return!1;u.click();let i=await t.waitUntilElementExist(document,n.customStatusInput);if(s!==a)return!1;i.value=e,i?.dispatchEvent(new window.Event("input",{bubbles:!0,cancelable:!0})),i?.dispatchEvent(new window.Event("keyup",{bubbles:!0,cancelable:!0})),l&&((await t.waitUntilElementExist(document,n.expandClearStatusButton)).click(),(await t.waitUntilElementExist(document,n.clearStatusNeverItem)).click());let E=await t.waitUntilElementExist(document,n.submitStatusButton);return s!==a?!1:(E.click(),window.localStorage.setItem("sidekick.last_status_text",e),o?.click(),!0)};t.observe(n.chatsLink,p),t.observe(n.activityLink,p),t.subscribeFocusMode(async e=>{if(!t.isLocalStorageItemExist(w))return;let a=Date.now();if(s=a,await t.waitDocReady(),a!==s||e.shouldBeSilent&&(await t.waitPageWillBeHidden(),a!==s))return;let r=Number(window.localStorage.getItem("sidekick.last_auto_sync_at")||""),l=i=>i/864e5,o=e.runEveryDays&&l(Date.now()-r)>e.runEveryDays;await b({dontClearStatus:Boolean(e.dontClearStatus),force:!!o,requestedAt:a,text:`${e.enabled?"Focus mode":"Available"} (via Sidekick Browser)`})&&(t.triggerAnalyticEvent("content-script.focus-mode-changed",{"is-focus-mode-set":e.enabled,"recipe-id":S.id}),o&&window.localStorage.setItem("sidekick.last_auto_sync_at",JSON.stringify(Date.now())))})});

