var e={unreadChats:'[data-testid="cell-frame-container"] div[role="gridcell"] > span > div:last-child > span[aria-label]',chatList:'[data-testid="chat-list"]',chatTitles:'[data-testid="cell-frame-container"] > div:last-child > div[role="gridcell"] span[title]',muted:'[data-testid="muted"]',side:"#side",chats:'[data-testid="cell-frame-container"]',searchField:"#side > div > div > div > div > div > div.copyable-text.selectable-text",title:"title"};var u=/\((\d+)\) WhatsApp/,d=(t,a)=>{try{if(!t.isLocalStorageItemExist(a)){t.setBadge(0);return}let r=document.querySelectorAll(e.unreadChats);if(r.length){let n=Array.from(r).filter(m=>!m.parentElement?.parentElement?.querySelector(e.muted)).length;t.setBadge(n);return}if(document.title==="WhatsApp"||document.title==="WhatsApp Web"){t.setBadge(0);return}let s=u.exec(document.title);if(!s)throw new Error("Title can't be matched by RegExp");let o=Number(s?.[1]);t.setBadge(o)}catch{let s=t.assert;s(!1,"Cant set badges")}};var i="#sidekick_";var h=t=>t.toUpperCase()!=t.toLowerCase()||(t?.codePointAt(0)??0)>127,E=t=>t.split("").some(h),c=(t,a)=>{try{if(!t.isLocalStorageItemExist(a))return;document.querySelectorAll(e.chatTitles).forEach(s=>{let o=s.getAttribute("title");if(!o)throw new Error("No title attribute");E(o)&&t.putResource(`https://web.whatsapp.com/${i}${encodeURIComponent(o)}`,{title:o})})}catch{let s=t.assert;s(!1,"Cant set chats resources")}};var p=t=>`No element for selector ${t}`;var l=async(t,a)=>{try{await t.waitDocReady();let r=document.location.hash;if(!r||!r.startsWith(i))return;let o=decodeURIComponent(r).split(i)[1];if(!o)return;let n=await t.waitUntilElementExist(document,e.searchField,a);if(!n)throw new Error(p("searchField"));await t.waitMS(50),n.dispatchEvent(new window.Event("focusin",{bubbles:!0,cancelable:!0})),await t.waitMS(50),n.dispatchEvent(new window.Event("focusin",{bubbles:!0,cancelable:!0})),await t.waitMS(50),n.innerHTML=o,n.dispatchEvent(new window.Event("input",{bubbles:!0,cancelable:!0})),await t.waitMS(50),n.dispatchEvent(new window.KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,code:"Enter",key:"Enter",keyCode:13}))}catch{let s=t.assert;s(!1,"Cant navigate to chat")}};window.sidekick(t=>{let a="critical_data_synced";t.observe(`${e.title}, ${e.unreadChats}, ${e.side}, ${e.chats}`,()=>d(t,a)),t.observe(e.chatList,()=>c(t,a)),window.addEventListener("hashchange",()=>{l(t,45e3).catch(console.error)}),c(t,a),l(t,45e3).catch(console.error)});

