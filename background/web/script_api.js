function y(s){var e=typeof s;return s!=null&&(e=="object"||e=="function")}var a=y;var o=(s,e,t=!0)=>t?Object.prototype.hasOwnProperty.call(s,e):e in s;var n=s=>a(s)&&o(s,"type")&&(typeof s.type=="string"||typeof s.type=="number"),p=(s,e)=>o(s,"scriptName")&&s.scriptName===e;var i=class{constructor(e){this.scriptName=e}isUnloaded=!1;destroyCallbacks=[];sendMessage(e){this.isUnloaded||chrome.runtime.sendMessage({...e,scriptName:this.scriptName})}onMessage(e){let t=r=>{!n(r)||!p(r,this.scriptName)||e(r)};return chrome.runtime.onMessage.addListener(t),()=>chrome.runtime.onMessage.removeListener(t)}unload(){this.destroyCallbacks.forEach(e=>e()),this.destroyCallbacks.length=0,this.isUnloaded=!0}onUnload(e){this.destroyCallbacks.push(e)}};export{i as ScriptApi};

